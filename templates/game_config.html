{% extends 'base.html' %}
{% load static %}

{% block title %}Configuración del Juego - Paddle Challenge{% endblock %}

{% block content %}
<style>
  .config-index { position:sticky; top:80px; }
  .config-index a { text-decoration:none; display:block; padding:6px 10px; border-radius:6px; font-size:.9rem; color:#444; }
  .config-index a:hover { background:#f1f1f1; }
  .config-section { scroll-margin-top:90px; }
  .card img { background:#111; }
</style>
<div class="container mt-4" style="max-width: 1150px;">
  <div class="d-flex justify-content-between align-items-center flex-wrap gap-3 mb-3">
    <h1 class="mb-0"><i class="fas fa-cogs me-2"></i>Configuración del Juego</h1>
    <a href="{% url 'home' %}" class="btn btn-sm btn-outline-secondary"><i class="fas fa-arrow-left me-1"></i>Volver</a>
  </div>
  <p class="text-muted mb-4">Guía visual y explicación de cada pantalla y opción dentro del juego. Usa el índice para saltar rápido.</p>

  <div class="row mb-4">
    <div class="col-lg-3 mb-4 config-index">
      <div class="card border-0 shadow-sm">
        <div class="card-header py-2 bg-light"><strong class="small"><i class="fas fa-list me-1"></i>Índice</strong></div>
        <div class="card-body py-2">
          <a href="#principal"><i class="fas fa-home me-1 text-primary"></i>Pantalla Principal</a>
          <a href="#gameplay"><i class="fas fa-play-circle me-1 text-success"></i>Gameplay</a>
          <a href="#progreso"><i class="fas fa-signal me-1 text-warning"></i>Progreso & Niveles</a>
            <a href="#nivel"><i class="fas fa-flag-checkered me-1 text-danger"></i>Nivel Completado</a>
          <a href="#config"><i class="fas fa-sliders-h me-1 text-info"></i>Configuraciones</a>
          <a href="#registro"><i class="fas fa-user-plus me-1 text-secondary"></i>Registro Nombre</a>
          <hr class="my-2">
          <a href="#puntuacion"><i class="fas fa-calculator me-1 text-primary"></i>Puntuación</a>
          <a href="#roadmap"><i class="fas fa-road me-1 text-success"></i>Roadmap</a>
          <a href="#faq"><i class="fas fa-circle-question me-1 text-warning"></i>FAQ</a>
          <a href="#feedback"><i class="fas fa-comment-dots me-1 text-danger"></i>Feedback</a>
        </div>
      </div>
    </div>
    <div class="col-lg-9">
      <div class="row g-4">
        <div class="col-md-12 config-section" id="principal">
          <div class="card h-100 shadow-sm border-0">
            <img src="{% static 'images/game/paddle-intro.png' %}" class="card-img-top" alt="Pantalla Principal" style="object-fit:cover;max-height:260px;">
            <div class="card-body">
              <h5 class="card-title"><i class="fas fa-home me-2 text-primary"></i>Pantalla Principal</h5>
              <p class="card-text small text-muted mb-2">El punto de entrada al juego. Debe ser clara, rápida y atractiva.</p>
              <ul class="small mb-0">
                <li><strong>Jugar:</strong> Inicia partida inmediata.</li>
                <li><strong>Configuración:</strong> Ajusta opciones (audio, control).</li>
                <li><strong>Salir:</strong> Cierra el juego o vuelve al launcher.</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="col-md-12 config-section" id="gameplay">
          <div class="card h-100 shadow-sm border-0">
            <img src="{% static 'images/game/gameplay.png' %}" class="card-img-top" alt="Gameplay" style="object-fit:cover;max-height:260px;">
            <div class="card-body">
              <h5 class="card-title"><i class="fas fa-play-circle me-2 text-success"></i>Gameplay</h5>
              <p class="card-text small text-muted mb-2">Interfaz activa durante la partida.</p>
              <ul class="small mb-0">
                <li><strong>Marcador:</strong> Actualizado en tiempo real.</li>
                <li><strong>Velocidad:</strong> Incremental por nivel.</li>
                <li><strong>Física:</strong> Rebotes y límites laterales.</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="col-md-12 config-section" id="progreso">
          <div class="card h-100 shadow-sm border-0">
            <img src="{% static 'images/game/scoring.png' %}" class="card-img-top" alt="Progreso" style="object-fit:cover;max-height:260px;">
            <div class="card-body">
              <h5 class="card-title"><i class="fas fa-signal me-2 text-warning"></i>Progreso & Niveles</h5>
              <p class="card-text small text-muted mb-2">Curva de dificultad y objetivos de avance.</p>
              <ul class="small mb-0">
                <li><strong>Escalado:</strong> Aumenta velocidad y patrones.</li>
                <li><strong>Indicadores:</strong> Barra o número de nivel.</li>
                <li><strong>Recompensas:</strong> Puntos o logros.</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="col-md-12 config-section" id="nivel">
          <div class="card h-100 shadow-sm border-0">
            <img src="{% static 'images/game/tournament.png' %}" class="card-img-top" alt="Nivel Completado" style="object-fit:cover;max-height:260px;">
            <div class="card-body">
              <h5 class="card-title"><i class="fas fa-flag-checkered me-2 text-danger"></i>Nivel Completado</h5>
              <p class="card-text small text-muted mb-2">Pantalla de fin de nivel con resultados.</p>
              <ul class="small mb-0">
                <li><strong>Puntaje:</strong> Puntos acumulados.</li>
                <li><strong>Acciones:</strong> Reintentar / Siguiente / Salir.</li>
                <li><strong>Efectos:</strong> Breve animación visual.</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="col-md-12 config-section" id="config">
          <div class="card h-100 shadow-sm border-0">
            <img src="{% static 'images/game/blog.png' %}" class="card-img-top" alt="Configuraciones" style="object-fit:cover;max-height:260px;">
            <div class="card-body">
              <h5 class="card-title"><i class="fas fa-sliders-h me-2 text-info"></i>Configuraciones</h5>
              <p class="card-text small text-muted mb-2">Pantalla de ajustes del usuario.</p>
              <ul class="small mb-0">
                <li><strong>Audio:</strong> Volumen maestro.</li>
                <li><strong>Controles:</strong> Sensibilidad / Reasignación.</li>
                <li><strong>Visual:</strong> Efectos básicos.</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="col-md-12 config-section" id="registro">
          <div class="card h-100 shadow-sm border-0">
            <img src="{% static 'images/game/community.png' %}" class="card-img-top" alt="Registro" style="object-fit:cover;max-height:260px;">
            <div class="card-body">
              <h5 class="card-title"><i class="fas fa-user-plus me-2 text-secondary"></i>Registro de Nombre</h5>
              <p class="card-text small text-muted mb-2">Ingreso del nombre del jugador previo a jugar.</p>
              <ul class="small mb-0">
                <li><strong>Validación:</strong> Longitud mínima y sin caracteres inválidos.</li>
                <li><strong>Persistencia:</strong> Guardar en local/session.</li>
                <li><strong>Acceso rápido:</strong> Botón continuar.</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Secciones adicionales únicas (reemplazan duplicados) -->
  <div class="row g-4 mt-2">
    <div class="col-12 config-section" id="puntuacion">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-body">
          <h4 class="card-title mb-3"><i class="fas fa-calculator me-2 text-primary"></i>Sistema de Puntuación</h4>
          <p class="small text-muted mb-3">Fórmula base utilizada para calcular el puntaje al final de cada nivel / partida.</p>
          <div class="bg-light rounded p-3 small mb-3">
            <code>Puntaje = (Golpes Exitosos * 10) + (Combo Máx * 25) - (Errores * 5) + (Nivel * 100)</code>
          </div>
          <ul class="small mb-0">
            <li><strong>Combo Máx:</strong> Bonificación exponencial si supera umbrales (10, 20, 30...).</li>
            <li><strong>Penalización por errores:</strong> Nunca reduce por debajo de 0.</li>
            <li><strong>Escalado por nivel:</strong> Aumenta incentivo a progresar.</li>
          </ul>
        </div>
      </div>
    </div>
    <div class="col-12 config-section" id="roadmap">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-body">
          <h4 class="card-title mb-3"><i class="fas fa-road me-2 text-success"></i>Roadmap Evolutivo</h4>
          <div class="row g-3 small">
            <div class="col-md-3">
              <div class="p-2 border rounded h-100">
                <strong>Fase 1</strong>
                <ul class="mb-0 ps-3">
                  <li>Mecánica básica</li>
                  <li>Registro usuario</li>
                  <li>Guardado partidas</li>
                </ul>
              </div>
            </div>
            <div class="col-md-3">
              <div class="p-2 border rounded h-100">
                <strong>Fase 2</strong>
                <ul class="mb-0 ps-3">
                  <li>Power-ups iniciales</li>
                  <li>Ranking público</li>
                  <li>Logros dinámicos</li>
                </ul>
              </div>
            </div>
            <div class="col-md-3">
              <div class="p-2 border rounded h-100">
                <strong>Fase 3</strong>
                <ul class="mb-0 ps-3">
                  <li>Multi-nivel avanzado</li>
                  <li>Skins / Temas</li>
                  <li>API pública</li>
                </ul>
              </div>
            </div>
            <div class="col-md-3">
              <div class="p-2 border rounded h-100">
                <strong>Fase 4</strong>
                <ul class="mb-0 ps-3">
                  <li>Modo competitivo</li>
                  <li>Eventos temporales</li>
                  <li>Anti-trampa</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-12 config-section" id="faq">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-body">
          <h4 class="card-title mb-3"><i class="fas fa-circle-question me-2 text-warning"></i>FAQ</h4>
          <div class="accordion accordion-flush" id="faqAccordion">
            <div class="accordion-item">
              <h2 class="accordion-header" id="fq1"><button class="accordion-button collapsed" data-bs-toggle="collapse" data-bs-target="#fq1c">¿Se guarda mi progreso?</button></h2>
              <div id="fq1c" class="accordion-collapse collapse" data-bs-parent="#faqAccordion"><div class="accordion-body small">Sí, cada partida registrada se asocia a tu cuenta y actualiza nivel y logros.</div></div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header" id="fq2"><button class="accordion-button collapsed" data-bs-toggle="collapse" data-bs-target="#fq2c">¿Habrá ranking global?</button></h2>
              <div id="fq2c" class="accordion-collapse collapse" data-bs-parent="#faqAccordion"><div class="accordion-body small">Está planificado en la Fase 2 junto con los power‑ups.</div></div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header" id="fq3"><button class="accordion-button collapsed" data-bs-toggle="collapse" data-bs-target="#fq3c">¿Puedo sugerir ideas?</button></h2>
              <div id="fq3c" class="accordion-collapse collapse" data-bs-parent="#faqAccordion"><div class="accordion-body small">Claro, utiliza el formulario de feedback para proponer mejoras.</div></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-12 config-section" id="feedback">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-body">
          <h4 class="card-title mb-3"><i class="fas fa-comment-dots me-2 text-danger"></i>¿Tienes Feedback?</h4>
          <p class="small text-muted">Ayúdanos a priorizar mejoras. Reporta bugs, ideas de balance o sugerencias de UX.</p>
          {% if user.is_authenticated %}
            <a href="{% url 'game:feedback' %}" class="btn btn-sm btn-outline-primary"><i class="fas fa-paper-plane me-1"></i>Enviar Feedback</a>
          {% else %}
            <a href="{% url 'login' %}" class="btn btn-sm btn-primary">Inicia sesión para enviar feedback</a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}